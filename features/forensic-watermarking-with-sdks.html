---
title: "Marca de agua forense con los SDK nativos"
description: "En este tema, aprenderá a usar los SDK nativos de Brightcove para entregar videos protegidos con marca de agua forense".
parent: Features 
grandparent: Home
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

  <section class="bcls-section">
    <h2 id="Introduction">Introducción</h2>
    <p>
      Con la marca de agua forense, puede proteger su contenido premium contra la piratería y el intercambio de contenido no autorizado. Esta función agrega una marca de agua invisible a sus videos, lo que le permite rastrear cualquier filtración de contenido.
    </p>
    <p>Para obtener más información, consulte el <a href="https://apis.support.brightcove.com/general/overview-forensic-watermarking.html">Visión general: Marca de agua forense</a> documento.</p>
  </section>

  <section class="bcls-section">
    <h2 id="Requirements">Requisitos</h2>
    <p>Se necesitan los siguientes requisitos para admitir esta función:</p>
    <h3>Configuración</h3>
    <p>Existen requisitos de instalación además de configurar su reproductor. Para obtener más detalles, consulte la <a href="https://apis.support.brightcove.com/general/overview-forensic-watermarking.html">Descripción general: Marca de agua forense</a> documento.</p>

    <h3>Versión del sistema operativo del dispositivo</h3>
    <ul>
      <li>Android 6.0 y más reciente</li>
      <li>iOS 11.0 y más reciente</li>
    </ul>

    <h3>Versión de Brightcove SDK</h3>
    <ul>
      <li>SDK nativo para Android 6.16.3 y versiones posteriores</li>
      <li>SDK nativo para iOS 6.9.0 y versiones posteriores</li>
    </ul>
  </section>

  <section class="bcls-section">
    <h2 id="Using_Playback_Rights_Android">Implementación de Android</h2>
    <p>La configuración de la marca de agua forense se realiza a nivel de vídeo.</p>
    
    <ol class="bcls-tasklist-restart">
      <li>
        <p>El reproductor debe estar integrado con su sistema de registro para que se transmita un ID de espectador en la baliza web de análisis (en la <code translate="No">user</code> campo).</p>
        <p>Por ejemplo:</p>
  <pre class="line-numbers"><code class="language-java" translate="No">HashMap&lt;String, String&gt; baseParams = new HashMap&lt;&gt;();
  baseParams.put(Analytics.Fields.USER, &quot;viewer id&quot;);
  baseParams.put(Analytics.Fields.APPLICATION_ID, &quot;application id&quot;);
  
  HashMap&lt;String, Object&gt; eventParams = new HashMap&lt;&gt;();
  eventParams.put(Analytics.Fields.BASE_PARAMS, baseParams);
  eventEmitter.emit(EventType.ADD_ANALYTICS_BASE_PARAMS, eventParams);          
</code></pre>
      </li>
      <li>
        <p>En el <code translate="No">Catalog.findVideo</code> o <code translate="No">Catalog.findPlaylist</code> llamadas a métodos, agregue el <code translate="No">VideoUtil</code> método para agregar su ficha de marca de agua.</p>

        <p><strong>En la devolución de llamada onVideo</strong></p>
        <pre><code class="language-java" translate="No">public void onVideo(Video video) {
    VideoUtil.addWatermarkingToken(video, yourWatermarkingToken);
    brightcoveVideoView.add(video);
} 
</code></pre>
        <p><strong>En la devolución de llamada de onPlaylist</strong></p>
        <pre><code class="language-java" translate="No">public void onPlaylist(Playlist playlist) {
  for (Video video : testPlaylist.getVideos()) {
      VideoUtil.addWatermarkingToken(video, yourWatermarkingToken);
  }
  brightcoveVideoView.addAll(testPlaylist.getVideos());
}
</code></pre>
      </li>
      <!-- <li>
        <p>
          <p>In the player Activity’s <code translate="No">onCreate</code> method, add this call, before any Catalog calls to retrieve your video or playlist:</p>
          <pre><code class="language-java" translate="No">VideoUtil.setWatermarkingToken(yourWatermarkingToken);
</code></pre>
        </p>
      </li> -->
      <li>
        <p>Con esta llamada en su lugar, cuando el catálogo recupera los metadatos de video o lista de reproducción de la API de reproducción, el <code translate="No">VideoUtil</code> la clase reemplazará el marcador de posición del token de marca de agua <code translate="No">{WMT}</code> con el valor del token, dondequiera que aparezca en las URL de origen del video. Este token se puede reemplazar para cada video en una lista de reproducción que puede tener marca de agua.</p>
      </li>
    </ol>

    <h3>Chromecast</h3>
    <p>Para transmitir un video con marca de agua, debe proporcionar su ID de aplicación, token de marca de agua e ID de usuario al crear su <code translate="No">BrightcoveCastCustomData</code> objeto con el complemento Cast.</p>
      <p>En su código para configurar el <code translate="No">BrightcoveCastCustomData</code> objeto, agregue esta línea:</p>
      <pre><code class="language-java" translate="No">public static void setupGoogleCast() {
GoogleCastComponent.Builder castPluginBuilder = new GoogleCastComponent.Builder(eventEmitter, context)
        .setAutoPlay(isAutoPlayEnabled)
        .setQueuingSupported(isQueuingSupported);

    BrightcoveCastCustomData.Builder customDataBuilder = new BrightcoveCastCustomData.Builder(context)
        .setApplicationId(yourApplicationId)
        .setWatermarkingToken(yourWatermarkingToken);
        .setUserId(yourUserId);
        // Add the custom data elements to the castPluginBuilder
        
    castPluginBuilder
        .setEnableCustomData(true)
        .setCustomData(customDataBuilder.build());
}            
</code></pre>

    <p>Cuando abres una conexión de transmisión con un video con marca de agua, deberías ver un <code translate="No">customData</code> objeto formateado así:</p>
    <pre><code class="language-json" translate="No">{
      &quot;accountId&quot;: &quot;yourAccountId&quot;,
      &quot;analyticsParams&quot;: {
          &quot;application&quot;: &quot;yourApplicationId&quot;,
          &quot;user&quot;: &quot;yourUserId&quot;
      },
      &quot;catalogParams&quot;: {
          &quot;type&quot;: &quot;video&quot;,
          &quot;id&quot;: &quot;videoId&quot;,
          &quot;policyKey&quot;: &quot;yourPolicyKey&quot;,
          &quot;watermarkingToken&quot;: &quot;yourWatermarkingToken&quot;
      }
  }  
</code></pre>

    <h3>Reproducción sin conexión</h3>
    <p>El proceso para descargar un video puede implicar más de una llamada al catálogo para recuperar los metadatos actuales del video. Brightcove recomienda agregar el <code translate="No">onVideo</code> código de devolución de llamada anterior a las devoluciones de llamada que pueden estar presentes al adquirir licencias de compra o alquiler y al descargar el video.
    </p>
    <p>Una vez que se haya descargado el video, la reproducción sin conexión debería funcionar como de costumbre.</p>
    <p>
      Para obtener más detalles, consulte la <a href="https://github.com/BrightcoveOS/android-player-samples/blob/master/brightcove-exoplayer/OfflinePlaybackSampleApp/src/main/java/com/brightcove/player/samples/offlineplayback/MainActivity.java">Aplicación de muestra de reproducción sin conexión</a>.
    </p>

  </section>

  <section class="bcls-section">
    <h2 id="iOS_Implementation">Implementación de iOS</h2>
    <p>
      Para configurar un reproductor para que utilice la marca de agua forense, siga estos pasos:
    </p>
    <ol class="bcls-tasklist-restart">
      <li>
        <p>El reproductor debe estar integrado con su sistema de registro para que se transmita un ID de espectador en la baliza web de análisis (en la <code translate="No">user</code> campo).</p>
        <p>Aquí, proporcionará valores para el ID de usuario y el ID de la aplicación:</p>
        <pre class="line-numbers"><code class="language-objectivec" translate="No">@try
  {
    [BCOVGlobalConfiguration.sharedConfig setValue:@{
      @&quot;privateUser&quot;: @&quot;your user id&quot;,
      @&quot;privateApplication&quot;: @&quot;your application id&quot;
    }
    forKey:@&quot;privateSessionAnalytics&quot;];
  }
  @catch (NSException *e)
  {
    NSLog(@&quot;%@&quot;, e.description);
  }       
</code></pre>
      </li>
      <li>
        <p>Como parte de la solicitud del catálogo de Brightcove para un solo video o una lista de reproducción, proporcionará su token de marca de agua NAGRA. Esto se hace usando el <code translate="No">watermarkingToken</code> propiedad.</p>
        <p>Agregue su ficha de marca de agua al servicio de reproducción.</p>
        <pre class="line-numbers"><code class="language-objectivec" translate="No">/**
* The watermarking token for use with Forensic Watermarking
*/
@property (nonatomic, copy) NSString *watermarkingToken;
...
playbackService.watermarkingToken = self.watermarkingToken;     
</code></pre>
      </li>
      <li>
        <p>Haga su solicitud al catálogo de Brightcove para un solo video o una lista de reproducción.</p>
        <p>Para una solicitud de video:</p>
<pre class="line-numbers"><code class="language-objectivec" translate="No">- (void)findVideoWithVideoID:(NSString *)videoID parameters:
  (NSDictionary *)parameters completion:(void (^)
  (BCOVVideo *video, NSDictionary *jsonResponse, NSError *error))completionHandler;
</code></pre>
        <p>Para una solicitud de lista de reproducción:</p>
<pre class="line-numbers"><code class="language-objectivec" translate="No">- (void)findPlaylistWithPlaylistID:(NSString *)playlistID parameters:
  (NSDictionary *)parameters completion:(void (^)
  (BCOVPlaylist *playlist, NSDictionary *jsonResponse, NSError *error))completionHandler;
</code></pre>   
      </li>
    </ol>
    <p>Para obtener más información, consulte la sección Marca de agua forense de la referencia del SDK nativo para iOS.</p>

    <h3>Chromecast</h3>
    <p>Para la transmisión, deberá proporcionar el token de marca de agua y los campos userId.</p>
      <p>En su código para configurar el <code translate="No">BrightcoveCastCustomData</code> objeto, agregue esta línea:</p>
      <pre><code class="language-objectivec" translate="No">BCOVReceiverAppConfig *appConfig = [BCOVReceiverAppConfig new];
...
appConfig.userId = @&quot;ios-client@brightcove.com&quot;;
appConfig.watermarkingToken = watermarkingToken;
...                 
</code></pre>

    <p>En la consola de depuración, puede ver los valores de configuración que se utilizarán para su sesión de Chromecast.</p>
    <pre><code class="language-json" translate="No">Google Cast Custom Data: {
  accountId = &lt;your_account_id&gt;;
  analyticsParams =     {
      application = &quot;&quot;;
      user = &quot;ios-client@brightcove.com&quot;;
  };
  catalogParams =     {
      adConfigId = &quot;&quot;;
      bcovAuthToken = &quot;&quot;;
      id = &lt;your_video_id&gt;;
      policyKey = &quot;&lt;your_policy_key&quot;;
      type = video;
      watermarkingToken = &quot;&lt;your_watermark_token&quot;;
  };    
</code></pre>

    <h3>Reproducción sin conexión</h3>
    <p>La reproducción sin conexión debería funcionar como de costumbre una vez que se descargue el video.</p>

    <p>
      Para comenzar con esta función, consulte la <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/OfflinePlayback.md">Guía del desarrollador de aplicaciones iOS para la reproducción sin conexión</a> referencia.
    </p>
  </section> 

  <section class="bcls-section">
    <h2 id="Limitations">Limitaciones</h2>
    <p>Para obtener detalles sobre las limitaciones de esta función, consulte la <a href="https://apis.support.brightcove.com/general/overview-forensic-watermarking.html#Limitations">Visión general: Marca de agua forense</a> documento.</p>
  </section>

</article>