---
title: 'Sincronización de subtítulos de WebVTT'
description: En este tema, aprenderá a configurar subtítulos WebVTT para videos HLS para sincronizar el audio y el video con los subtítulos.
parent: Features 
grandparent: Home
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">Descripción general</h2>

<p>El archivo Web Video Text Tracks (WebVTT) es un archivo de texto simple que se utiliza para asociar títulos, subtítulos, descripciones, etc., con segmentos de tiempo en su video.</p>

<pre class="line-numbers">
<code class="language-html" translate="No">WEBVTT

  00:00:03.50 --&gt; 00:00:05.000 align:middle line:84%
  In this video, you'll learn
  about how Video Cloud Studio is</code></pre>

<p>Para obtener detalles sobre cómo agregar un archivo WebVTT, consulte la <a href="https://player.support.brightcove.com/general/adding-captions-videos-programmatically.html">Agregar subtítulos a los videos</a> documento.</p>

<!-- <p>The <a href="https://github.com/brightcove/brightcove-player-sdk-ios-sidecarsubtitles">Sidecar Subtitles plugin</a> enables you to use WebVTT captions in your iOS and tvOS apps.</p> -->
</section>

<section class="bcls-section">
<h2 id="Add_a_metadata_header">Agregar un encabezado de metadatos</h2>

<p>Como parte de la especificación HLS, debe agregar un <code translate="No">X-TIMESTAMP-MAP</code> encabezado de metadatos a cada encabezado de WebVTT para sincronizar las marcas de tiempo entre el audio y el video con sus subtítulos.</p>

<p>Si falta este encabezado o el <code translate="No">MPEGTS</code> El valor no es correcto, es posible que vea que sus subtítulos no están sincronizados con el video. Esto se debe a que cuando <code translate="No">X-TIMESTAMP-MAP</code> Falta el encabezado, el cliente asume un desplazamiento de marca de tiempo predeterminado de <strong>0</strong>. Por ejemplo, la diferencia entre usar un valor de <strong>900000</strong> y <strong>0</strong> puede hacer que sus subtítulos se desvíen 10 segundos.</p>

<p><code translate="No">X-TIMESTAMP-MAP</code> formato:</p>

<pre class="line-numbers">
<code class="language-swift" translate="No">X-TIMESTAMP-MAP=MPEGTS:&lt;MPEG-2 time&gt;,LOCAL:&lt;cue time&gt;</code></pre>
<!-- <p><code data-gist-id="d59006640cce4709fdc2" data-gist-line="2" data-gist-hide-footer="true"></code></p> -->

<p>Aquí hay un archivo WebVTT de muestra:</p>

<aside class="bcls-aside bcls-aside--information">los <code translate="No">X-TIMESTAMP-MAP</code> El encabezado debe aparecer en la línea 2, directamente después del <code translate="No">WEBVTT</code> línea. Puede experimentar resultados inesperados si el encabezado de la marca de tiempo no se coloca en la línea 2.</aside>

<pre class="line-numbers">
<code class="language-swift" translate="No">WEBVTT
<span class="bcls-highlight">X-TIMESTAMP-MAP=MPEGTS:900000,LOCAL:00:00:00.000</span>

1
00:00:03.500 --&gt; 00:00:05.000 align:middle line:84%
In this video, you'll learn
about how Video Cloud Studio is</code></pre>
<!-- <p><code data-gist-id="d59006640cce4709fdc2" data-gist-line="5-11" data-gist-highlight-line="6" data-gist-hide-footer="true"></code></p> -->

<p>Para obtener más detalles, consulte la <a href="https://tools.ietf.org/html/draft-pantos-http-live-streaming-18#section-3">Segmentos de subtítulos</a> sección del documento de protocolo HLS de Apple.</p>
</section>

<section class="bcls-section">
<h2 id="Determine_the_offset_value">Determine el valor de compensación</h2>

<p>Si está utilizando Dynamic Ingest o Zencoder de Brightcove para transcodificar su contenido, use un valor de compensación de <code translate="No">MPEGTS:900000</code>.</p>

<p>Si está utilizando un sistema de codificación que no sea Zencoder, es mejor obtener el valor necesario. Apple recomienda que configure el desplazamiento para que coincida con su video codificado.</p>

<p>La <code translate="No">MPEGTS</code> El valor corresponde al valor de la marca de tiempo de presentación (PTS) de la trama MPEG en el <code translate="No">LOCAL</code> hora. Si está utilizando el sistema de ingesta heredado de Brightcove, puede encontrar que puede usar un valor de <code translate="No">MPEGTS:0</code>.</p>

<p>Si su cuenta está habilitada para <a href="https://studio.support.brightcove.com/general/overview-dynamic-delivery.html">Entrega dinámica</a> y estás alojando subtítulos con nosotros <em>(subtítulos no remotos)</em>, luego haremos que todo funcione automáticamente de forma mágica (PTS debe ser cero y nos aseguraremos de que sea así).</p>

<p>Si su cuenta está habilitada para Dynamic Delivery y está utilizando <strong><em>remoto</em></strong> subtítulos, deberá establecer el valor de PTS en cero.</p>

<p>Por ejemplo, para obtener el valor de compensación, puede hacer lo siguiente:</p>

<h3>Solicitud1:</h3>

<p>En la terminal, obtenga un video HLS y guárdelo en un archivo local. En este caso, lo estamos nombrando <code translate="No">seg.ts</code>.</p>

<pre class="line-numbers">
<code class="language-http" translate="No">curl -o seg.ts "http://brightcove.vo.llnwd.net/v1/unsecured/media/4360108595001/201507/1154/4360341622001/4360108595001_4360341622001_s-1.ts?pubId=4360108595001&amp;videoId=4360283683001"</code></pre>
<!-- <p><code data-gist-id="d59006640cce4709fdc2" data-gist-line="17-18"></code></p> -->

<h3>Solicitud2:</h3>

<p>Luego, usa el <code translate="No">ffprobe</code> comando para obtener el valor de compensación. <code translate="No">ffprobe</code> es un analizador de flujo multimedia, que forma parte del <a href="//ffmpeg.org/about.html">Marco FFmpeg</a>. Deberá descargarlo e instalarlo en su computadora.</p>

<pre class="line-numbers">
<code class="language-http" translate="No">ffprobe -show_frames seg.ts</code></pre>

<h3>Respuesta:</h3>

<p>Tu respuesta debería ser similar a esta:</p>

<pre class="line-numbers">
<code class="language-html" translate="No"><span class="bcls-highlight">pkt_pts=900000</span>
pkt_pts_time=10.000000
pkt_dts=900000
pkt_dts_time=10.000000</code></pre>
<!-- <p><code data-gist-id="d59006640cce4709fdc2" data-gist-line="21-24" data-gist-highlight-line="21" data-gist-hide-footer="true"></code></p> -->

<br/>
<aside class="bcls-aside bcls-aside--warning">Agregar el encabezado X-TIMESTAMP-MAP puede causar inconsistencias en otras plataformas, como las aplicaciones de Windows Mobile. Asegúrese de probar en todas las plataformas después de agregar el encabezado de compensación. La adición de esta etiqueta de encabezado es un requisito de especificación de HLS y no un parámetro de especificación de WebVTT.</aside>
</section>

<section class="bcls-section">
<h2 id="Best_practices">Mejores prácticas</h2>

<p>Las siguientes pautas deberían ayudar al desarrollar su aplicación con subtítulos.</p>

<h3>Duración de los subtítulos</h3>

<p>Se recomienda que la duración de los subtítulos no exceda la duración del video. Esto evitará que se muestren subtítulos o que aparezca un área que no se puede buscar en la barra de progreso después de que se haya completado la reproducción del video.</p>
</section>
</article>