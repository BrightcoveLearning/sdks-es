<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>Referencia de Brightcove Native Player para iOS</title>

	<link rel="stylesheet" href="css/style.css">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1.4">
	<meta name="generator" content="appledoc 2.2.1 (build 1334)">
</head>
<body class="appledoc">
	<header>
		<div class="container" class="hide-in-xcode">
			
			<h1 id="library-title"> <a href="index.html">Reproductor nativo de Brightcove para iOS </a> </h1>

			<p id="developer-home">
				Brightcove<a href="index.html"></a>
			</p>
			
		</div>
	</header>

	<aside>
		<div class="container">
			<nav>
				<ul id="header-buttons" role="toolbar">
					<li><a href="hierarchy.html">Jerarquía</a></li>
				</ul>
			</nav>
		</div>
	</aside>

	<article>
		<div id="overview-contents" class="container">
			<div id="content">
				<main role="main">
					<h1 class="title">Referencia de Brightcove Native Player para iOS</h1>

					
					<div class="section section-overview index-overview">
						
						
						<h1>Complemento IMA para Brightcove Player SDK para iOS, versión 6.9.0.1697</h1> <h1>Requisitos</h1>

<ul>
<li>Xcode 11.0+</li>
<li>ARCO</li>
</ul>


<h1>Plataformas compatibles</h1>

<p>iOS 11.0 y superior.</p>

<h1>Instalación</h1>

<p>El complemento IMA para Brightcove Player SDK proporciona un marco de biblioteca dinámico para la instalación.</p>

<p>El complemento IMA es compatible con la versión 3.12.1 del SDK de IMA de Google para iOS y la versión 4.3.2 del SDK de IMA de Google para tvOS.</p>

<h2>CocoaPods</h2>

<p>Puedes usar <a href="http://cocoapods.org">CocoaPods</a> para agregar el complemento IMA para Brightcove Player SDK a su proyecto. Puedes encontrar lo último <code>Brightcove-Player-IMA</code> podspec <a href="https://github.com/brightcove/BrightcoveSpecs/tree/master/Brightcove-Player-IMA">aquí</a>. El pod incorporará la versión correcta de IMA automáticamente. Se requiere CocoaPods 1.0 o más reciente.</p>

<p>Ejemplo de CocoaPod Podfile:</p>

<pre><code>fuente 'https://github.com/brightcove/BrightcoveSpecs.git' use_frameworks! platform:ios, '11.0' objetivo 'MyIMAPlayer' do pod 'Brightcove-player-IMA' end </code></pre>

<p>A partir de la versión 3.4.1 de IMA, AdMob se publica como un marco dinámico independiente y ya no se puede instalar como parte del complemento IMA para Brightcove Native Player SDK. Como tal, ya no hay un <code>ForAdMob</code> subespec para podspec. Para usar AdMob, descárguelo y agréguelo a su proyecto manualmente, o agregue el <code>Google-Mobile-Ads-SDK</code> CocoaPod a su Podfile:</p>

<pre><code>pod 'Google Mobile-ADS-SDK' </code></pre>

<p>Al actualizar su instalación,&rsquo;Es una buena idea actualizar la copia local de su repositorio BrightcoveSpecs para que tenga las últimas podspecs localmente, al igual que actualizaría su repositorio principal de CococaPods.</p>

<p>Normalmente, si usa <code>actualización de la vaina</code> en Terminal esto sucederá automáticamente, o alternativamente puede actualizar explícitamente con <code>actualización de repositorio de pod Brightcove</code>. (Su repositorio de BrightcoveSpecs puede tener un nombre diferente si lo agregó explícitamente a su lista de repositorios de podspecs).</p>

<h2>Manual</h2>

<p>Para agregar el complemento IMA para Brightcove Player SDK a su proyecto manualmente:</p>

<ol>
<li>Descargar el <a href="https://github.com/brightcove/brightcove-player-sdk-ios/releases">SDK de Brightcove Player</a> estructura.</li>
<li>Descargar el <a href="https://github.com/brightcove/brightcove-player-sdk-ios-ima/releases">Complemento IMA para Brightcove Player SDK</a> estructura.</li>
<li>Descargar el <a href="https://developers.google.com/interactive-media-ads/docs/sdks/ios/download">IMA de Google</a> estructura.</li>
<li>Sobre el &ldquo;General&rdquo; pestaña del destino de su aplicación, agregue el <strong>dinámica</strong> framework, BrightcovePlayerSDK.framework, desde la descarga de Brightcove Player SDK a la lista de <strong>Frameworks, bibliotecas, contenido incrustado</strong>. El marco dinámico, BrightcovePlayerSDK.framework, se encuentra en el directorio ios / dynamic de la descarga.</li>
<li>Sobre el &ldquo;General&rdquo; pestaña del destino de su aplicación, agregue BrightcoveIMA.framework del complemento IMA para la descarga del SDK del reproductor Brightcove a la lista de <strong>Frameworks, bibliotecas, contenido incrustado</strong>.</li>
<li>Sobre el &ldquo;General&rdquo; pestaña del destino de su aplicación, agregue GoogleInteractiveMediaAds.framework de la descarga de IMA de Google a la lista de <strong>Frameworks, bibliotecas, contenido incrustado</strong>.</li>
<li>Sobre el &ldquo;Configuración de compilación&rdquo; pestaña del destino de su aplicación, asegúrese de que el &ldquo;Rutas de búsqueda del marco&rdquo; incluir las rutas a los marcos. Esto debería haberse hecho automáticamente a menos que el marco esté almacenado en un directorio raíz diferente al de su proyecto.</li>
<li>Sobre el &ldquo;Configuración de compilación&rdquo; pestaña del destino de su aplicación:

<ul>
<li>Asegurarse de que <code>-ObjC</code> ha sido agregado a la &ldquo;Otras banderas del vinculador&rdquo; entorno de construcción.</li>
</ul>
</li>
</ol>


<h2>Importaciones</h2>

<p>El complemento IMA para Brightcove Player SDK se puede importar en código de diferentes formas; <code>@import BrightcoveIMA;</code> , <code>#importar &lt;BrightcoveIMA / BrightcoveIMA.h&gt;</code> o <code>#import &lt;BrightcoveIMA / [clase específica] .h&gt;</code>. Puede importar el <code>GoogleInteractiveMediaAds</code> y <code>BrightcovePlayerSDK</code> módulos de manera similar.</p>

<h1>Inicio rápido</h1>

<p>El complemento BrightcoveIMA es un puente entre <a href="https://developers.google.com/interactive-media-ads/docs/sdks/ios/download">SDK de IMA para iOS de Google v3</a> y el <a href="https://github.com/brightcove/brightcove-player-sdk-ios">SDK de Brightcove Player para iOS</a>. Este fragmento muestra su uso básico con las reglas de anuncios VMAP.</p>

<pre><code>[1] IMASettings * imaSettings = [[IMASettings alloc] init]; imaSettings.ppid = kViewControllerIMAPublisherID; imaSettings.language = kViewControllerIMALanguage; IMAAdsRenderingSettings * renderSettings = [[IMAAdsRenderingSettings alloc] init]; renderSettings.webOpenerPresentingController = self; UIView * videoContainerView = &lt;UIView del contenedor de video&gt;; NSString * adTag = &lt;etiqueta de anuncio&gt;; [2] BCOVIMAAdsRequestPolicy * adsRequestPolicy = [BCOVIMAAdsRequestPolicy adsRequestPolicyWithVMAPAdTagUrl: adTag]; BCOVPlayerSDKManager * manager = [BCOVPlayerSDKManager sharedManager]; id &lt;BCOVPlaybackController&gt; controller = [3] [manager createIMAPlaybackControllerWithSettings: imaSettings adsRenderingSettings: renderSettings adsRequestPolicy: adsRequestPolicy adContainer: videoContainerView viewController: self companionSlots: nil viewStrategy: nil controller.delegate = self; [videoContainerView addSubview: controller.view]; NSString * policyKey = &lt;your-policy-key&gt;; NSString * accountId = &lt;your-ccount-id&gt;; NSString * videoID = &lt;your-video-id&gt;; BCOVPlaybackService * playbackService = [[BCOVPlaybackService alloc] initWithAccountId: accountID policyKey: policyKey]; [playbackService findVideoWithVideoID: videoID parameters: nil completado: ^ (BCOVVideo * video, NSDictionary * jsonResponse, NSError * error) { [controller setVideos:@[ video ]]; [controller play]; }]; </code></pre>

<p>Desglosando el código en pasos:</p>

<ol>
<li>Cree la misma configuración de IMA, configuración de representación de anuncios que crearía si estuviera usando Google&rsquo;s SDK de IMA para iOS directamente. Estos son obligatorios.</li>
<li><a href="Classes/BCOVIMAAdsRequestPolicy.html">BCOVIMAAdsRequestPolicy</a> proporciona métodos para especificar reglas de anuncios VAST o VMAP. Seleccione el método apropiado para seleccionar su política de anuncios.</li>
<li>BrightcoveIMA agrega algunos métodos de categoría a BCOVPlaybackManager. El primero de estos es <code>-createIMAPlaybackControllerWithSettings: adsRenderingSettings: adsRequestPolicy: adContainer: companionSlots: viewStrategy:</code>. Utilice este método para crear su controlador de reproducción.</li>
</ol>


<h1>Reproducir y pausar</h1>

<p>Brightcove IMA Plugin implementa una lógica de pausa y reproducción personalizada para garantizar la experiencia publicitaria más fluida posible. Por lo tanto, deberá asegurarse de utilizar el método de reproducción en el <code>BCOVPlaybackController</code> o la <code>[BCOVSessionProviderExtension ima_play]</code> o <code>[BCOVSessionProviderExtension ima_pause]</code> (<a href="https://github.com/brightcove/brightcove-player-sdk-ios-ima/blob/master/ios/BrightcoveIMA.framework/Headers/BCOVIMAComponent.h">BCOVSessionProviderExtension</a> y no el AVPlayer.</p>

<p>Como ejemplo, llamar al juego por primera vez en <code>BCOVPlaybackController</code> permite a BCOVIMA procesar anuncios pre-roll sin que se reproduzca nada del contenido antes del pre-roll. Para obtener más información sobre cómo BCOVIMA anula el valor predeterminado <code>BCOVPlaybackController</code> métodos, por favor echa un vistazo <a href="https://github.com/brightcove/brightcove-player-sdk-ios-ima/blob/master/ios/BrightcoveIMA.framework/Headers/BCOVIMAComponent.h">BCOVSessionProviderExtension</a>.</p>

<h1>Uso de la PlayerUI incorporada</h1>

<p>En tus <code>UIViewController</code> , crear un <code>BCOVPUIPlayerView</code> propiedad llamada vista de reproductor, para contener los controles de reproducción, la vista de contenido de video y una vista especial donde IMA puede mostrar sus anuncios.</p>

<pre><code>// Vista del reproductor de PlayerUI @property (no atómico) BCOVPUIPlayerView * playerView; </code></pre>

<p>Luego crea tu vista de jugador; suministre un controlador de reproducción nulo que se agregará más adelante. Esta vista de reproductor contiene tanto la vista de contenido de video como la vista que muestra controles de reproducción y controles de anuncios. Esta configuración es la misma sin importar qué complemento esté utilizando. Configure la vista del reproductor para que coincida con el contenedor de video de su diseño (<code>videoView</code> ) cuando cambia de tamaño.</p>

<pre><code>// Cree y configure la Vista de control. BCOVPUIBasicControlView * controlView = [BCOVPUIBasicControlView basicControlViewWithVODLayout]; // Crea la vista del reproductor con un controlador de reproducción nulo. self.playerView = [[BCOVPUIPlayerView alloc] initWithPlaybackController: ninguna opción: ninguna controlView: controlView]; // Agrega BCOVPUIPlayerView a tu vista de video. [self.videoView addSubview: self.playerView]; </code></pre>

<p>usted&rsquo;Necesitará configurar el diseño para la vista del jugador, puede hacerlo con Auto Layout o con el método anterior Springs &amp; Struts.</p>

<p><strong>Resortes y puntales</strong> <code> self.playerView.frame = self.videoView.bounds; self.playerView.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth; </code></p>

<p><strong>Diseño automático</strong> <code> self.playerView.translatesAutoresizingMaskIntoConstraints = NO; [NSLayoutConstraint activeConstraints: @ [[self.playerView.topAnchor constrintEqualToAnchor: self.videoView.topAnchor], [self.playerView.rightAnchor constraintEqualToAnchor: self.videoView.rightAnchor], [self.playerView.leftAnchorvideoAnchorrest.quot. , [self.playerView.bottomAnchor constraintEqualToAnchor: self.videoView.bottomAnchor],]]; </code></p>

<p>La creación del controlador de reproducción es específica de IMA. Cree su controlador de reproducción como lo hizo anteriormente, pero en lugar de su vista de contenedor de video, pase el <code>contentOverlayView</code> desde la vista del jugador como tu <code>adContainer</code>. los <code>contentOverlayView</code> es una vista especial que se utiliza para superponer vistas en el contenido del video principal.</p>

<pre><code>// Crea el controlador de reproducción. id &lt;BCOVPlaybackController&gt; controller = [manager createIMAPlaybackControllerWithSettings: imaSettings adsRenderingSettings: renderSettings adsRequestPolicy: adsRequestPolicy adContainer: self.playerView.contentOverlayView // vista especial para el contenido de anuncios de IMA viewController: nil companion viewController: self companion viewController; controller.delegate = self; // Asignar un nuevo controlador de reproducción a la vista del reproductor. // Esto asocia la sesión del playerController con PlayerUI. // Puede mantener esta vista de reproductor y asignarle nuevos // controladores de reproducción a medida que se crean. self.playerView.playbackController = self.playbackController; </code></pre>

<p>Ahora, cuando reproduzca videos con anuncios, verá los controles de PlayerUI mientras reproduce contenido de video, además de marcadores de anuncios en el depurador de la línea de tiempo (solo anuncios VMAP).</p>

<p>PlayerUI es altamente personalizable. Para obtener más información y código de muestra, consulte <strong>Diseños personalizados</strong> sección en el archivo README.md del <a href="https://github.com/brightcove/brightcove-player-sdk-ios">Repositorio de Brightcove Native Player SDK</a>.</p>

<h1>Buscar sin anuncios</h1>

<p>Usar <code> [BCOVPlaybackController seekWithoutAds: (CMTime) seekToTime deploymentHandler: (void (^) (BOOL terminado)) completado]</code> para reanudar la reproducción en un momento específico sin obligar al usuario a ver anuncios programados antes <code>seekToTime</code>.</p>

<p>En preparación para <code>seekWithoutAds: CompletionHandler:</code> , desactivar <code>auto-reproducción</code> al configurar el <code>BCOVPlaybackController</code>.</p>

<p>Apple recomienda esperar a que el estado de un AVPlayerItem cambie a listo para jugar antes de usar AVPlayerItem. Por lo tanto, llama <code>seekWithoutAds: CompletionHandler:</code> en el <code>kBCOVPlaybackSessionLifecycleEventReady</code> manejador de la <code>playbackController: playbackSession: didReceiveLifecycleEvent</code> método de tu <code>BCOVPlaybackControllerDelegate</code>.</p>

<p>`` `objetivo-c - (void) control de reproducción: (NSObject<BCOVPlaybackController><em>) controlador de reproducción Sesión: (NSObject<BCOVPlaybackSession></em>) sesión didReceiveLifecycleEvent: (BCOVPlaybackSessionLifecycleEvent *) lifecycleEvent {if ([kBCOVPlaybackSessionLifecycleEventReady isEqualToString: lifecycleEvent.eventType]) {// self.resumePlayback es una variable de instancia hipotética utilizada aquí como ilustración. if (self.resumePlayback) {__weak typeof (controlador) débilController = controlador;</p>

<pre><code>// buscar sin reproducir anuncios que están programados antes de la hora de búsqueda, es decir, reanudar la reproducción. [controlador seekWithoutAds: CMTimeMake (seekWithoutAdsValue, seekWithoutAdsTimescale) CompletionHandler: ^ (BOOL terminado) { if (!finished) { NSLog (@"seekWithoutAds failed to finish"); } typeof (controlador) strongController = débilController; si (strongController) { // fade out the shutter to reveal the player view. strongController.shutterFadeTime = 0.25; strongController.shutter = NO; // turn off seek without ads - especially important if this player is being used with a playlist self.resumePlayback = NO; } }]; } </code></pre>

<p>  }} `` `</p>

<p>los <code>obturador</code> y <code>obturadorFadeTime</code> propiedades de la <code>BCOVPlaybackController</code> se puede utilizar junto con <code>seekWithoutAds: CompletionHandler:</code> para ocultar el parpadeo de fotogramas que puede ocurrir cuando AVPlayer carga los activos. En su código de configuración de BCOVPlaybackController, habilite el obturador para ocultar la vista del reproductor:</p>

<p>`` objetivo-c NSObject<BCOVPlaybackController> * control de reproducción;</p>

<p>  playbackController = [sdkManager createFWPlaybackControllerWithAdContextPolicy: nil viewStrategy: nil]; playbackController.delegate = self;</p>

<p>  if (self.resumePlayback) {// establece el tiempo de desvanecimiento del obturador en cero para ocultar la vista del jugador inmediatamente. playbackController.shutterFadeTime = 0.0; playbackController.shutter = YES;</p>

<pre><code>// deshabilita la reproducción automática al reanudar la reproducción. playbackController.autoPlay = NO; </code></pre>

<p>  } `` `</p>

<p>Tenga en cuenta que cuando se utiliza Buscar sin anuncios en su aplicación, es posible que observe el tráfico de red que normalmente ocurre como parte de la configuración del complemento IMA. Este tráfico es necesario para la configuración adecuada del complemento y no afecta la funcionalidad Buscar sin anuncios.</p>

<h1>Personalización del comportamiento del complemento</h1>

<p>Hay un par de puntos de configuración en BCOVIMA. Puede combinar BCOVIMA con otro complemento para Brightcove Player SDK para iOS, puede crear una estrategia de visualización personalizada y puede proporcionar una política de solicitud de anuncios personalizada.</p>

<h2>Reglas de anuncios VAST y VMAP</h2>

<p>BCOVIMA le da control sobre cómo se realizan las solicitudes de anuncios, a través del <a href="Classes/BCOVIMAAdsRequestPolicy.html"><code>BCOVIMAAdsRequestPolicy</code></a> clase. La clase proporciona métodos de fábrica para las políticas admitidas. Una vez que obtenga una instancia de la póliza correcta, debe proporcionarla al <code>BCOVPlayerSDKManager</code> para crear un controlador de reproducción o un proveedor de sesiones de reproducción.</p>

<p>En Quick Start, se ofrece un ejemplo de VMAP. A continuación, se muestra un ejemplo de VAST.</p>

<pre><code> IMASettings * imaSettings = [[IMASettings alloc] init]; imaSettings.ppid = kViewControllerIMAPublisherID; imaSettings.language = kViewControllerIMALanguage; IMAAdsRenderingSettings * renderSettings = [[IMAAdsRenderingSettings alloc] init]; renderSettings.webOpenerPresentingController = self; UIView * videoContainerView = &lt;UIView del contenedor de video&gt;; [1] BCOVIMAAdsRequestPolicy * adsRequestPolicy = [BCOVIMAAdsRequestPolicy adsRequestPolicyWithVASTAdTagsInCuePointsAndAdsCuePointProgressPolicy: nil]; BCOVPlayerSDKManager * manager = [BCOVPlayerSDKManager sharedManager]; id &lt;BCOVPlaybackController&gt; controller = [manager createIMAPlaybackControllerWithSettings: imaSettings adsRenderingSettings: renderSettings adsRequestPolicy: adsRequestPolicy adContainer: videoContainerView viewController: self companionSlots: nulo viewStrategy: nil]; </code></pre>

<p>Dejar&rsquo;s divide este código en pasos, para que sea un poco más fácil de digerir:</p>

<ol>
<li>Este ejemplo es el mismo que el proporcionado en el inicio rápido, excepto que ahora estamos llamando a un <code>BCOVIMAAdsRequestPolicy</code> método de política para especificar que queremos utilizar VAST.</li>
</ol>


<p><a href="Classes/BCOVIMAAdsRequestPolicy.html">BCOVIMAAdsRequestPolicy</a> tiene cuatro métodos de fábrica para generar una política de solicitud de anuncios; dos para VMAP y dos para VAST. A continuación, se describen con más detalle dos métodos de fábrica para VMAP:</p>

<ul>
<li><p><code>+ videoPropertiesVMAPAdTagUrlAdsRequestPolicy</code>: Este método devuelve la política de solicitud de anuncios predeterminada, que busca el <code>kBCOVIMAAdTag</code> en cada BCOVVideo&rsquo;s para determinar la etiqueta de anuncio VMAP que se debe utilizar para solicitar anuncios.</p></li>
<li><p><code>+ adsRequestPolicyWithVMAPAdTagUrl:</code>: Este método devuelve una política de solicitud de anuncios que siempre usa la misma etiqueta de anuncio para cada video. Si utiliza esta política, no es necesario que coloque la etiqueta de anuncio en BCOVVideos.' propiedades. Esta es la forma más sencilla de especificar una etiqueta de anuncio si sabe que su etiqueta de anuncio nunca cambiará durante la duración de la sesión de la aplicación.</p></li>
</ul>


<p>Hay dos métodos de fábrica para VAST. Todos los métodos VAST toman una BCOVCuePointProgressPolicy. La política de puntos de referencia determina qué BCOVCuePoints serán procesados por el <a href="Classes/BCOVIMAAdsRequestPolicy.html">BCOVIMAAdsRequestPolicy</a>. Las políticas de VAST son las siguientes:</p>

<ul>
<li><p><code>+ adsRequestPolicyWithVASTAdTagsInCuePointsAndAdsCuePointProgressPolicy:</code> Este método devuelve una política de solicitud de anuncios que verifica cada BCOVVideo en busca de BCOVCuePoints de tipo &lsquo;kBCOVIMACuePointTypeAd&rsquo; y busca en cada una de esas propiedades de los puntos de referencia la clave <code>kBCOVIMAAdTag</code> para determinar la etiqueta de anuncio VAST que se debe utilizar para solicitar anuncios.</p></li>
<li><p><code>+ adsRequestPolicyFromCuePointPropertiesWithAdTag: adsCuePointProgressPolicy:</code> Este método devuelve una política de solicitud de anuncios que utiliza la etiqueta de anuncio VAST especificada para todos los BCOVCuePoints de tipo <strong>kBCOVIMACuePointTypeAd</strong>. Las propiedades del punto de referencia se agregan a la etiqueta de anuncio como parámetros de consulta.</p></li>
</ul>


<p>Puede agregar puntos de referencia de etiquetas publicitarias de VAST a un video mediante el <code>actualizar:</code> método en el <code>BCOVVídeo</code> objeto. El siguiente ejemplo agrega puntos de referencia pre-roll, mid-roll y post-roll:</p>

<pre><code>// Objective-C - (BCOVVideo *) updateVideo: (BCOVVideo *) video { // Determine mid-point of video so we can insert a cue point there CGFloat durationMiliSeconds = ((NSNumber *)video.properties[@"duration"]).doubleValue; CGFloat midpointSeconds = (durationMiliSeconds / 2) / 1000; CMTime midpointTime = CMTimeMakeWithSeconds(midpointSeconds, 1); return [video update:^(id&lt;BCOVMutableVideo&gt; mutableVideo) { mutableVideo.cuePoints = [[BCOVCuePointCollection alloc] initWithArray:@[ [[BCOVCuePoint alloc] initWithType:kBCOVIMACuePointTypeAd position:kCMTimeZero properties:@{ kBCOVIMAAdTag : kVASTAdTagURL }], [[BCOVCuePoint alloc] initWithType: kBCOVIMACuePointTypeAd posición: midpointTime propiedades: @{ kBCOVIMAAdTag : kVASTAdTagURL }], [[BCOVCuePoint alloc] initWithType: kBCOVIMACuePointTypeAd posición: kBCOVCuePointPositionTypeAfter propiedades: @{ kBCOVIMAAdTag : kVASTAdTagURL } ]]]; }]; } </code></pre>

<pre><code>// Swift func updateVideo (withVASTTag vastTag: String) -&gt; BCOVVideo? { guard let durationNum = self.properties["duration"] as? NSNumber else { return nil } let durationMiliSeconds = durationNum.doubleValue let midpointSeconds = (durationMiliSeconds / 2) / 1000 let midpointTime = CMTimeMakeWithSeconds (midpointSeconds, preferenciaTimescale: 1) let cuePointPositionTypeAfter = CMTime.positiveInfinity devolver la actualización { (mutableVideo: BCOVMutableVideo?) in guard let mutableVideo = mutableVideo else { return } mutableVideo.cuePoints = BCOVCuePointCollection (matriz: [BCOVCuePoint (tipo: kBCOVIMACuePointTypeAd, posición: CMTime.zero, propiedades: [kBCOVIMAAdTag: vastTag]) !, BCOVCuePoint (tipo: kBCOVIMACuePointTypeAd, posición: midpointTime, propiedades: [kBCOVIMAAdTag: vastTag]) !, BCOVCuePoint (tipo: kBCOVCOVagIMAdTag: [ ]) !,])}} </code></pre>

<p>También puede convertir los puntos de referencia creados en VideoCloud en puntos de referencia de VAST como este:</p>

<pre><code>- (BCOVVideo *) updateVideo: (BCOVVideo *) video NSArray * cuePoints = video.cuePoints.array; NSMutableArray * updatedCuePoints = @ []. MutableCopy; para (BCOVCuePoint * cuePoint en cuePoints) { if ([cuePoint.type isEqualToString:kBCOVIMACuePointTypeAd]) { // The "metadata" property is the value of the // "Key/Value Pairs" field in VideoCloud when // creating/editing a Cue Point. In this example // the only value in this field is the VAST ad tag URL. // If you have additional values you'll need to parse // out just the ad tag URL. NSString *metadata = cuePoint.properties[@"metadata"]; NSDictionary *properties = @{ kBCOVIMAAdTag : metadata } ; BCOVCuePoint * updatedCuePoint = [[BCOVCuePoint alloc] initWithType: cuePoint.type position: cuePoint.position properties: properties]; [updatedCuePoints addObject: updatedCuePoint]; }} return [actualización de video: ^ (id &lt;BCOVMutableVideo&gt; mutableVideo) { mutableVideo.cuePoints = [BCOVCuePointCollection collectionWithArray:updatedCuePoints]; }]; } </code></pre>

<h2>Modificación de IMAAdsRequest</h2>

<p>El complemento IMA pasa un <code>IMAAdsRequest</code> objetar a un <code>BCOMIMAPlaybackSessionDelegate</code> inmediatamente antes de llamar <code>IMAAdsLoader -requestAdsWithAdsRequest</code> , lo que permite al usuario modificar primero la solicitud de anuncios. Para recibir la devolución de llamada de solicitud de anuncios, cree un objeto que implemente la <a href="Protocols/BCOVIMAPlaybackSessionDelegate.html"><code>BCOVIMAPlaybackSessionDelegate</code></a> protocolo.</p>

<pre><code>@import BrightcovePlayerSDK; @import BrightcoveIMA; @interface MyViewController: UIViewController BCOVIMAPlaybackSessionDelegate </code></pre>

<p>Crear un <code>BCOVIMASessionProvider</code> usando cualquiera <code>createIMAPlaybackControllerWithSettings</code> o <code>createIMASessionProviderWithSettings</code> , y proporcionar un NSDictionary de opciones con una entrada que tenga una clave de <code>kBCOVIMAOptionIMAPlaybackSessionDelegateKey</code> y un valor que es tu delegado.</p>

<pre><code>NSDictionary * imaSessionProviderOptions = @{ kBCOVIMAOptionIMAPlaybackSessionDelegateKey: self } ; id &lt;BCOVPlaybackSessionProvider&gt; imaSessionProvider = [sdkManager createIMASessionProviderWithSettings: imaSettings adsRenderingSettings: renderSettings adsRequestPolicy: adsRequestPolicy adContainer: self.playerView.contentOverlay viewControlots: self.playerView.contentOverlay viewControlots opciones: selfView viewControlots; </code></pre>

<p>Implementar <code>willCallIMAAdsLoaderRequestAdsWithRequest: forPosition:</code> en tus <code>BCOVIMAPlaybackSessionDelegate</code>.</p>

<pre><code>- (void) willCallIMAAdsLoaderRequestAdsWithRequest: (IMAAdsRequest *) adsRequest forPosition: (NSTimeInterval) posición { adsRequest.vastLoadTimeout = 3000.; } </code></pre>

<h2>Ver estrategia</h2>

<p>Puede proporcionar una estrategia de vista personalizada a BCOVPlaybackManager cuando está construyendo su controlador de reproducción o proveedor de sesión, en lugar de especificar defaultControlsViewStrategy directamente. Con una estrategia de vista personalizada, la vista del contenedor de anuncios y los espacios para anuncios complementarios se pueden vincular con la vista de contenido de video. Este es un ejemplo de estrategia de vista personalizada.</p>

<pre><code>BCOVPlaybackControllerViewStrategy customViewStrategy = ^ UIView * (UIView * vista, id &lt;BCOVPlaybackController&gt; playbackController){ BCOVPlaybackControllerViewStrategy defaultControlsViewStrategy = [playbackManager defaultControlsViewStrategy]; UIView *contentAndDefaultControlsView = defaultControlsViewStrategy(view, playbackController); [&lt;UIView of video container&gt; addSubview:contentAndDefaultControlsView]; return &lt;UIView of video container&gt;; } ; </code></pre>

<h2>Proveedores de sesiones de composición</h2>

<p>Si está utilizando más de un complemento para Brightcove Player SDK para iOS que necesita crear un controlador de reproducción personalizado, en su lugar debe componer una cadena de proveedores de sesión y pasar el proveedor de sesión final al <code>[BCOVPlayerSDKManager createPlaybackControllerWithSessionProvider: viewStrategy:]</code> método.</p>

<p>Al componer proveedores de sesiones, la precarga de sesiones se puede habilitar desde <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/fd5e766693e533854f202f270d3d62e32ceaae04/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVBasicSessionProvider.h#L31-L46"><code>BCOVBasicSessionProvider</code></a> ; sin embargo, la precarga de sesiones con el complemento IMA es <strong>fuertemente desanimado</strong> debido a un error en el SDK de IMA de Google al tener varios AVPlayers en la memoria.</p>

<h1>Registro de superposiciones de anuncios</h1>

<p>Si está colocando vistas sobre anuncios mientras se reproducen, es necesario registrar esas vistas con el SDK de IMA. Leer el <strong>Obstrucciones amistosas</strong> sección de la <a href="https://developers.google.com/interactive-media-ads/docs/sdks/ios/omsdk">Medición abierta en el SDK de IMA </a> página para obtener más información.</p>

<p>Puede obtener el objeto IMAAdDisplayContainer actual necesario para registrar sus superposiciones desde el <code>playbackController: playbackSession: didEnterAdSequence:</code> método delegado de su instancia de BCOVPlaybackController. Por ejemplo: <code> - (void) playbackController: (id &lt;BCOVPlaybackController&gt;) controller playbackSession: (id &lt;BCOVPlaybackSession&gt;) sesión didEnterAdSequence: (BCOVAdSequence *) adSequence { NSDictionary *props = session.video.properties; IMAAdDisplayContainer *adDisplayContainer = props[kBCOVIMAVideoPropertiesKeyAdDisplayContainer]; [adDisplayContainer registerFriendlyObstruction:self.adOverlayView]; } </code></p>

<p>Para anular el registro de las obstrucciones cuando finaliza la secuencia de anuncios, el <code>playbackController: playbackSession: didSalirAdSequence:</code> Se puede utilizar el método delegado de su instancia de BCOVPlaybackController. Por ejemplo: <code> - (void) playbackController: (id &lt;BCOVPlaybackController&gt;) controller playbackSession: (id &lt;BCOVPlaybackSession&gt;) sesión didExitAdSequence: (BCOVAdSequence *) adSequence { NSDictionary *props = session.video.properties; IMAAdDisplayContainer *adDisplayContainer = props[kBCOVIMAVideoPropertiesKeyAdDisplayContainer]; [adDisplayContainer unregisterAllFriendlyObstructions]; } </code></p>

<h1>Salida en antena</h1>

<p>El complemento IMA es compatible con AirPlay para anuncios pre-roll y post-roll. Colocar <code>enableBackgroundPlayback</code> para <code>SÍ</code> sobre <code>IMASettings</code> además de habilitar AirPlay en su <code>BCOVPlaybackController</code>. Ver el &ldquo;<em>Salida en antena</em>&rdquo; sección de la <a href="https://github.com/brightcove/brightcove-player-sdk-ios#airplay-">Léame del SDK principal</a> para más información.</p>

<h1>Orientación por segmento de público</h1>

<p>Si tu&rsquo;Si desea utilizar la segmentación por segmento de audiencia con sus solicitudes de anuncios IMA VAST, puede hacerlo mediante el <code>updateAudienceSegmentTargetingValues</code> sobre <code>BCOVPlaybackController</code>. Por ejemplo:</p>

<pre><code>[playbackController updateAudienceSegmentTargetingValues: @{ @"account_id":@"11223344", @"account_type":@"premium"" }]; </code></pre>

<p>Estos valores se agregarán al <code>cust_params</code> parámetro de consulta de la URL de solicitud de anuncios de IMA. Por ejemplo:</p>

<p>La URL <a href="http://pubads.g.doubleclick.net/gampad/ads"><code>http://pubads.g.doubleclick.net/gampad/ads</code></a> se convertiría <a href="http://pubads.g.doubleclick.net/gampad/ads?cust_params=account_id%3D11223344%26account_type%3Dpremium"><code>http://pubads.g.doubleclick.net/gampad/ads?cust_params=account_id%3D11223344%26account_type%3Dpremium</code></a>.</p>

<h1>Orientación de anuncios por dispositivo</h1>

<p>Puedes usar el <code>kBCOVIMAOptionBlockAdTargetingAPIsKey</code> al configurar su <code>IMASessionProvider</code> o IMA <code>BCOVPlaybackController</code> para evitar llamadas a <a href="https://developer.apple.com/documentation/adsupport">AdSupport</a> y <a href="https://developer.apple.com/documentation/apptrackingtransparency">Transparencia de seguimiento de aplicaciones</a> API que no se pueden utilizar en algunos escenarios de envío de la App Store.</p>

<pre><code>// BCOVPlaybackController NSDictionary * imaPlaybackSessionOptions = @{ kBCOVIMAOptionIMAPlaybackSessionDelegateKey: self, kBCOVIMAOptionBlockAdTargetingAPIsKey: @(YES) } ; self.playbackController = [manager createIMAPlaybackControllerWithSettings: imaSettings adsRenderingSettings: renderSettings adsRequestPolicy: adsRequestPolicy adContainer: self.playerView.contentOverlayView viewController: self companionSlots: nil viewStraessionaOptionsback options: </code></pre>

<pre><code>// IMASessionProvider NSDictionary * imaPlaybackSessionOptions = @{ kBCOVIMAOptionIMAPlaybackSessionDelegateKey: self, kBCOVIMAOptionBlockAdTargetingAPIsKey: @(YES) } ; id &lt;BCOVPlaybackSessionProvider&gt; imaSessionProvider = [gestor createIMASessionProviderWithSettings: imaSettings adsRenderingSettings: renderSettings adsRequestPolicy: adsRequestPolicy adContainer: self.playerView.contentOverlayView ViewControlleres upProvider opciones: </code></pre>

<h1>Preguntas frecuentes</h1>

<p><em>Puedo escuchar los anuncios, pero puedo&rsquo;t verlos jugar.</em></p>

<p>Esto suele ocurrir cuando la vista del contenedor de anuncios no está en la jerarquía de vistas o cuando la vista del anuncio (que es una subvista de la vista del contenedor de anuncios) está cubierta por otras vistas.</p>

<h1>Apoyo</h1>

<p>Si tiene preguntas, necesita ayuda o desea enviar comentarios, utilice el <a href="https://supportportal.brightcove.com/s/login/">Portal de soporte</a> o comuníquese con su administrador de cuentas. Para recibir una notificación de las nuevas versiones del software SDK, suscríbase a los SDK de Brightcove Native Player <a href="https://groups.google.com/g/brightcove-native-player-sdks">Grupo de Google</a>.</p>
						
						
					</div>
					

					<div class="index-container">
						

						
						<div class="index-column">
							<h2 class="index-title">Referencias de clase</h2>
							<ul>
								
								<li>BCOVIMAAdsRequestPolicy<a href="Classes/BCOVIMAAdsRequestPolicy.html"></a></li>
								
								<li><a href="Classes/BCOVIMAComponent.html">BCOVIMA Componente</a></li>
								
							</ul>
						</div>
						

						
						<div class="index-column">
							
							<h2 class="index-title">Referencias de protocolo</h2>
							<ul>
								
								<li>BCOVIMAPlaybackSessionDelegate<a href="Protocols/BCOVIMAPlaybackSessionDelegate.html"></a></li>
								
							</ul>
							

							

							
							<h2 class="index-title">Referencias de categoría</h2>
							<ul>
								
								<li><a href="Categories/BCOVPlayerSDKManager-BCOVIMAAdditions.html">BCOVPlayerSDKManager (BCOVIMAAdditions)</a></li>
								
								<li><a href="Categories/BCOVSessionProviderExtension-BCOVIMAAdditions.html">BCOVSessionProviderExtension (BCOVIMAAdditions)</a></li>
								
							</ul>
							
						</div>
						
					</div>

					<footer>
						<div class="footer-copyright">
							
							<p class="copyright">Derechos de autor &copy; 2021 Brightcove. Reservados todos los derechos. Actualizado: 2021-07-08</p>
							
							
							<p class="generator">Generado por <a href="http://appledoc.gentlebytes.com">appledoc 2.2.1 (compilación 1334)</a>.</p>
							
						</div>
					</footer>
				</main>
			</div>
		</div>
	</article>

	<script src="js/script.js"></script>
</body>
</html>
