---
title: 'Migración a ExoPlayer 2 Framework'
description: En este tema, aprenderá a utilizar el marco ExoPlayer 2 con Brightcove Native Player SDK para Android.
parent: Framework 
grandparent: Android Development
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">Descripción general</h2>
<aside class="bcls-aside bcls-aside--information">
<p>El SDK nativo de Brightcove para Android con ExoPlayer 1 ha quedado obsoleto.</p>

<p>Si es necesario, puede ver el <a href="/android/reference/exoplayer1/javadoc/index.html">la documentación de referencia de ExoPlayer 1</a> , pero se recomienda que migre a ExoPlayer 2 Framework.</p>
</aside>

<p><a href="https://google.github.io/ExoPlayer/">ExoPlayer de Google</a> es un reproductor multimedia de código abierto a nivel de aplicación para Android. Brightcove aprovecha ExoPlayer para aprovechar los beneficios que ofrece. Para obtener más información sobre los beneficios de actualizar a ExoPlayer, consulte la <a href="https://www.brightcove.com/en/blog/2018/01/brightcove-native-sdk-exoplayer-2">SDK nativo de Brightcove con ExoPlayer 2</a> entrada en el blog.</p>

<p>Aprenda a migrar para los siguientes tipos de proyectos:</p>

<ul>
	<li><a href="#New_project">Nuevo proyecto</a></li>
	<li><a href="#Existing_ExoPlayer_1_project">Proyecto ExoPlayer 1 existente</a></li>
	<li><a href="#Existing_MediaPlayer_project">Proyecto de MediaPlayer existente</a></li>
</ul>

<p>Referirse a <a href="https://github.com/BrightcoveOS/android-player-samples">Aplicaciones de muestra de ExoPlayer</a> para obtener orientación adicional sobre la integración del <a href="https://medium.com/google-exoplayer/exoplayer-2-x-new-package-and-class-names-ef8e1d9ba96f">ExoPlayer 2</a> framework en tu proyecto.</p>
</section>

<section class="bcls-section">
<h2 id="New_project">Nuevo proyecto</h2>

<p>Siga estos pasos para agregar ExoPlayer 2 a un nuevo proyecto de Android:</p>

<ol class="bcls-tasklist">
	<li>En tus <strong>build.gradle</strong> archivo, agregue la siguiente dependencia:

	<pre class="line-numbers">
<code class="language-java" translate="No">dependencies {
  implementation "com.brightcove.player:exoplayer2:${anpVersion}"
}</code></pre>
	</li>
	<li>Establecer el <code translate="No">transitive</code> opción a <code translate="No">true</code> le dice a Gradle que incluya automáticamente otras dependencias, como el complemento de reproducción sin conexión. Si está utilizando una versión de Gradle menor que 5, el <a href="https://docs.gradle.org/current/userguide/dependency_management.html">dependencias transitivas</a> están desactivados de forma predeterminada. Por lo tanto, deberá agregar la siguiente declaración:
	<pre class="line-numbers">
<code class="language-java" translate="No">dependencies {
  implementation "com.brightcove.player:exoplayer2:${anpVersion}" <span class="bcls-highlight">{transitive = true}</span>
}</code></pre>
	</li>
	<li>Si está utilizando una variable de entorno para la versión del SDK, abra el <strong>gradle.properties</strong> y establezca el valor de la versión actual del SDK nativo para Android. Debería verse similar a esto:
	<pre class="line-numbers">
<code class="language-java" translate="No">anpVersion=6.5.0</code></pre>
	</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Existing_ExoPlayer_1_project">Proyecto ExoPlayer 1 existente</h2>

<p>Siga estos pasos para actualizar un proyecto de ExoPlayer 1 existente para usar el marco de ExoPlayer 2:</p>

<ol class="bcls-tasklist-restart">
	<li>En tus <strong>constants.gradle</strong> archivo, actualice la versión de Android Build Tools:

	<pre class="line-numbers">
<code class="language-java" translate="No">buildToolsVersion "28.0.2"
</code></pre>
	</li>
	<li>En tus <strong>build.gradle</strong> archivo, actualice las bibliotecas de soporte de Android:
	<pre class="line-numbers">
<code class="language-java" translate="No">implementation 'com.android.support:appcompat-v7:${APPCOMPAT_V7_VERSION}'
implementation 'com.android.support:support-v4:${SUPPORT_V4_VERSION}'
implementation 'com.android.support:recyclerview-v7:${SUPPORT_V4_VERSION}'
implementation 'com.android.support:support-vector-drawable:${SUPPORT_V4_VERSION}'
</code></pre>

	<p>Los valores actuales de las constantes se pueden encontrar en la <a href="https://github.com/BrightcoveOS/android-player-samples/blob/master/constants.gradle">constants.gradle</a> expediente.</p>
	</li>
	<li>En tus <strong>build.gradle</strong> archivo, agregue el repositorio de Google Maven:
	<pre class="line-numbers">
<code class="language-java" translate="No">maven {
  url 'https://maven.google.com'
}
</code></pre>
	</li>
	<li>Si su proyecto utiliza publicidad con Google IMA, actualice Google Play Services Ads:
	<pre class="line-numbers">
<code class="language-java" translate="No">implementation 'com.google.android.gms:play-services-ads:'+PLAY_SERVICES_VERSION
</code></pre>

	<aside class="bcls-aside bcls-aside--information">Es importante tener en cuenta aquí que Brightcove Native Player SDK para Android no es compatible con aplicaciones que intentan utilizar ExoPlayer y ExoPlayer 2.</aside>
	</li>
	<li>En tus <strong>build.gradle</strong> archivo, donde previamente importó la biblioteca Brightcove ExoPlayer como una dependencia como esta:
	<pre class="line-numbers">
<code class="language-java" translate="No">dependencies {
  implementation "com.brightcove.player:exoplayer:${anpVersion}"
}
</code></pre>

	<p>Cambie el nombre de la dependencia:</p>

	<pre class="line-numbers">
<code class="language-java" translate="No">dependencies {
  implementation "com.brightcove.player:exoplayer2:${anpVersion}"
}
</code></pre>

	<p>El valor actual de la versión Brightcove SDK (<code translate="No">anpVersion</code> ) se puede encontrar en el <a href="https://github.com/BrightcoveOS/android-player-samples/blob/master/gradle.properties">gradle.properties</a> expediente.</p>
	</li>
	<li>Establecer el <code translate="No">transitive</code> opción a <code translate="No">true</code> le dice a Gradle que incluya automáticamente otras dependencias, como el complemento de reproducción sin conexión. Si está utilizando una versión de Gradle menor que 5, el <a href="https://docs.gradle.org/current/userguide/dependency_management.html">dependencias transitivas</a> están desactivados de forma predeterminada. Por lo tanto, deberá agregar lo siguiente:
	<pre class="line-numbers">
<code class="language-java" translate="No">dependencies {
	implementation "com.brightcove.player:exoplayer2:${anpVersion}" <span class="bcls-highlight">{transitive = true}</span>
}</code></pre>
	</li>
	<li>Si está utilizando una variable de entorno para la versión del SDK, abra el <strong>gradle.properties</strong> y establezca el valor de la versión actual del SDK nativo para Android. Debería verse similar a esto:
	<pre class="line-numbers">
<code class="language-java" translate="No">anpVersion=6.5.0</code></pre>

	<p>No debería requerirse codificación adicional para integrar ExoPlayer 2 en su proyecto.</p>
	</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Existing_MediaPlayer_project">Proyecto de MediaPlayer existente</h2>

<p>Siga estos pasos para actualizar un proyecto de MediaPlayer existente para usar el marco ExoPlayer 2:</p>

<ol class="bcls-tasklist-restart">
	<li>En tus <strong>build.gradle</strong> archivo, agregue la siguiente dependencia:

	<pre class="line-numbers">
<code class="language-java" translate="No">dependencies {
  implementation "com.brightcove.player:exoplayer2:${anpVersion}"
}</code></pre>
	</li>
	<li>Establecer el <code translate="No">transitive</code> opción a <code translate="No">true</code> le dice a Gradle que incluya automáticamente otras dependencias, como el complemento de reproducción sin conexión. Si está utilizando una versión de Gradle menor que 5, el <a href="https://docs.gradle.org/current/userguide/managing_transitive_dependencies.html">dependencias transitivas</a> están desactivados de forma predeterminada. Por lo tanto, deberá agregar lo siguiente:
	<pre class="line-numbers">
<code class="language-java" translate="No">dependencies {
  implementation "com.brightcove.player:exoplayer2:${anpVersion}" <span class="bcls-highlight">{transitive = true}</span>
}</code></pre>
	</li>
	<li>Si está utilizando una variable de entorno para la versión del SDK, abra el <strong>gradle.properties</strong> y establezca el valor de la versión actual del SDK nativo para Android. Debería verse similar a esto:
	<pre class="line-numbers">
<code class="language-java" translate="No">anpVersion=6.5.0</code></pre>
	</li>
	<li>En su aplicación, use el <a href="/android/reference/javadoc/com/brightcove/player/view/BrightcoveExoPlayerVideoView.html">BrightcoveExoPlayerVideoView</a> en vez de <a href="/android/reference/javadoc/com/brightcove/player/view/BrightcoveVideoView.html">BrightcoveVideoView</a> , que utiliza Android Media Player.</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Breaking_changes">Rompiendo cambios</h2>

<p>Los siguientes cambios en Brightcove Native SDK para Android son cambios importantes con ExoPlayer 2. El uso de ExoPlayer 1 ha quedado obsoleto con Brightcove Native SDK.</p>

<h3>Oyentes internos de ExoPlayerVideoDisplayComponent</h3>

<p>La <code translate="No">ExoPlayerVideoDisplayComponent</code> class le permite configurar oyentes para obtener el estado de los componentes de ExoPlayer. A continuación se muestra una lista de algunos de los oyentes:</p>

<table class="bcls-table">
	<thead class="bcls-table__head">
		<tr>
			<th>Establecer el oyente</th>
			<th>Recibir información de estado sobre</th>
		</tr>
	</thead>
	<tbody class="bcls-table__body">
		<tr>
			<td>setDebugListener</td>
			<td>InfoListener</td>
		</tr>
		<tr>
			<td>setCaptionListener</td>
			<td>CaptionListener</td>
		</tr>
		<tr>
			<td>setMetadataListener</td>
			<td>MetadataListener</td>
		</tr>
		<tr>
			<td>setInternalErrorListener</td>
			<td>InternalErrorListener</td>
		</tr>
	</tbody>
</table>

<p>A continuación se presentan recomendaciones para usar ExoPlayer 2.</p>

<h4>InfoListener</h4>

<p>Para el <code translate="No">InfoListener</code> interfaz, se realizaron los siguientes cambios:</p>

<ul>
	<li>La <code translate="No">onAvailableRangeChanged</code> el método fue eliminado</li>
	<li>La <code translate="No">onLoadStarted</code> El método tiene un adicional <code translate="No">length</code> parámetro</li>
</ul>

<p>Ejemplo: ExoPlayerVideoDisplayComponent usando ExoPlayer 2</p>

<pre class="line-numbers">
<code class="language-java" translate="No">public interface InfoListener {
void onVideoFormatEnabled(Format format, int trigger, long mediaTimeMs);
void onAudioFormatEnabled(Format format, int trigger, long mediaTimeMs);
void onDroppedFrames(int count, long elapsed);
void onBandwidthSample(int elapsedMs, long bytes, long bitrateEstimate);
void onLoadStarted(int sourceId, int type, int trigger, Format format,
				long mediaStartTimeMs, long mediaEndTimeMs);
void onLoadCompleted(int sourceId, long bytesLoaded, int type, int trigger, Format format,
				long mediaStartTimeMs, long mediaEndTimeMs, long elapsedRealtimeMs, long loadDurationMs);
void onDecoderInitialized(String decoderName, long initializedTimestampMs,
				long initializationDurationMs);
}</code></pre>

<h4>CaptionListener</h4>

<p>La <code translate="No">CaptionListener</code> la interfaz no ha cambiado.</p>

<p>Ejemplo: ExoPlayerVideoDisplayComponent usando ExoPlayer v2</p>

<pre class="line-numbers">
<code class="language-java" translate="No">public interface CaptionListener {
void onCues(List&lt;Cue&gt; cues);
}</code></pre>

<h4>MetadataListener</h4>

<p>La <code translate="No">MetadataListener</code> La interfaz se introdujo con ExoPlayer v2. El uso anterior del <code translate="No">Id3MetadataListener</code> ahora está en desuso.</p>

<p>Ejemplo: ExoPlayerVideoDisplayComponent usando ExoPlayer v2</p>

<pre class="line-numbers">
<code class="language-java" translate="No">public interface MetadataListener {
void onMetadata(Metadata metadata);
}</code></pre>

<p>Con el nuevo <code translate="No">MetadataListener</code> recibirás un <code translate="No">Metadadata</code> objeto en el <code translate="No">onMetadata</code> llamar de vuelta. Con el desaprobado <code translate="No">Id3MetadataListener</code> , recibió una lista de objetos Id3Frame. Con el nuevo oyente, aún puede obtener una lista de <code translate="No">Id3Frame</code> objetos como se muestra a continuación:</p>

<pre class="line-numbers">
<code class="language-java" translate="No">exoPlayerVideoDisplayComponent.setMetadataListener(new ExoPlayerVideoDisplayComponent.MetadataListener() {
@Override
public void onMetadata(Metadata metadata) {
 for(int i = 0; i &lt; metadata.length(); i++) {
		 Metadata.Entry entry = metadata.get(i);
		 if (entry instanceof Id3Frame) {
				 Id3Frame id3Frame = (Id3Frame) entry;
		 }
 }
}
});
</code></pre>

<h4>InternalErrorListener</h4>

<p>La <code translate="No">InternalErrorListener</code> La interfaz tiene muchos cambios. Por favor, consulte el código a continuación para comparar:</p>

<p>ExoPlayerVideoDisplayComponent usando ExoPlayer v2</p>

<pre class="line-numbers">
<code class="language-java" translate="No">public interface InternalErrorListener {
void onPlayerError(Exception e);
void onAudioTrackUnderrun(int bufferSize, long bufferSizeMs, long elapsedSinceLastFeedMs);
void onLoadError(int sourceId, IOException e);
void onDrmSessionManagerError(Exception e);
}
</code></pre>

<p>ExoPlayerVideoDisplayComponent usando ExoPlayer v1 (<strong>obsoleto</strong>)</p>

<pre class="line-numbers">
<code class="language-java" translate="No">public interface InternalErrorListener {
void onRendererInitializationError(Exception e);
void onAudioTrackInitializationError(AudioTrack.InitializationException e);
void onAudioTrackWriteError(AudioTrack.WriteException e);
void onAudioTrackUnderrun(int bufferSize, long bufferSizeMs, long elapsedSinceLastFeedMs);
void onDecoderInitializationError(MediaCodecTrackRenderer.DecoderInitializationException e);
void onCryptoError(MediaCodec.CryptoException e);
void onLoadError(int sourceId, IOException e);
void onDrmSessionManagerError(Exception e);
}
</code></pre>

<p>Al usar ExoPlayer 2, el tipo de excepción que obtiene <code translate="No">onPlayerError(Exception e)</code> es <code translate="No">com.google.android.exoplayer2.ExoPlaybackException</code> , pero esto puede cambiar en el futuro.</p>

<p>Al usar com.google.android.exoplayer2.ExoPlaybackException, puede obtener los siguientes tipos de excepción:</p>

<ul>
	<li><code translate="No">ExoPlaybackException.TYPE_SOURCE</code></li>
	<li><code translate="No">ExoPlaybackException.TYPE_RENDERER</code></li>
	<li><code translate="No">ExoPlaybackException.TYPE_UNEXPECTED</code></li>
</ul>

<p>También puede recuperar la causa del error obteniendo el <code translate="No">Throwable</code> objeto con <code translate="No">ExoPlaybackException.getSourceException()</code>.</p>

<h3>Soporte de reproducción sin conexión</h3>

<p>Si su proyecto utiliza el <code translate="No">MediaDownloadable.setConfigurationBundle(Bundle)</code> método para especificar las preferencias de descarga, como la tasa de bits de video, luego actualice su código de la siguiente manera:</p>

<p>Formato antiguo (obsoleto)</p>

<pre class="line-numbers">
<code class="language-java" translate="No">com.google.android.exoplayer.MediaFormat
</code></pre>

<p>Nuevo formato</p>

<pre class="line-numbers">
<code class="language-java" translate="No">com.brightcove.player.model.MediaFormat
</code></pre>

<h3>Clases de API de medios heredados</h3>

<p>Las clases de API de medios heredadas en desuso, en el <code translate="No">com.brightcove.player.media package</code> , se eliminaron del SDK nativo de Brightcove para Android.</p>

<p>Si estaba usando las clases de medios, debe migrar y comenzar a usar las <code translate="No">com.brightcove.player.edge.Catalog</code> clase.</p>

<p>Las siguientes clases se movieron de <code translate="No">com.brightcove.player.media</code> a <code translate="No">com.brightcove.player.model</code>:</p>

<ul>
	<li><code translate="No">DeliveryType.java</code></li>
	<li><code translate="No">CaptionType.java</code></li>
	<li><code translate="No">ErrorFields.java</code></li>
	<li><code translate="No">VideoFields.java</code></li>
</ul>

<aside class="bcls-aside bcls-aside--tip">Si está utilizando cualquiera de estas cuatro clases, solo necesita reemplazar el paquete de importación y estará todo listo.</aside>
</section>

<section class="bcls-section">
<h2 id="Additional_Resources">Recursos adicionales</h2>

<p>Para obtener más información sobre el uso del marco ExoPlayer 2, consulte los siguientes documentos:</p>

<ul>
	<li><a href="https://medium.com/google-exoplayer/exoplayer-2-x-new-package-and-class-names-ef8e1d9ba96f">ExoPlayer 2 - Nuevos paquetes y nombres de clases</a></li>
	<li><a href="https://google.github.io/ExoPlayer/guide.html">Guía para desarrolladores de ExoPlayer</a></li>
</ul>
</section>
</article>