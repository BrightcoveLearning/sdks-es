---
title: 'Selección de subtítulos mediante programación con el SDK nativo para Android'
description: En este tema, aprenderá a seleccionar subtítulos mediante programación cuando utilice Brightcove Native SDK para Android.
parent: Captions 
grandparent: Android Development
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>


<section class="bcls-section">
  <h2 id="Overview">Descripción general</h2>
  <p>
    El SDK nativo para Android recibe subtítulos de cualquiera de los siguientes:
  </p>
  <ul>
    <li>Respuesta del catálogo de Brightcove (API de reproducción): Sidecar WebVTT</li>
    <li>Manifiesto de video (HLS o DASH): WebVTT en manifiesto</li>
  </ul>
  <p>
    Para obtener más información sobre los subtítulos, consulte la <a href="https://sdks.support.brightcove.com/features/using-captions-brightcove-native-sdks.html">Uso de subtítulos con los SDK nativos de Brightcove</a> documento.
  </p>
</section>

<section class="bcls-section">
  <h2 id="Event_sequence">Secuencia de eventos</h2>
  <p>
    El SDK nativo sigue esta secuencia de eventos asociada con los subtítulos:
  </p>
  <ol class="bcls-tasklist">
    <li>
      <p>
        Recupere un video del catálogo de Brightcove (p. Ej. <code translate="No">catalog.findVideoByID()</code>).
      </p>
    </li>
    <li>
      <p>
        Los subtítulos de sidecar se analizan a partir de la respuesta del catálogo y se agregan a las propiedades del video.
      </p>
    </li>
    <li>
      <p>
        En este punto, puede recuperar las fuentes de subtítulos de la siguiente manera:
      </p>
      <pre><code class="language-java" translate="No">video.getProperties().get(Video.Fields.CAPTION_SOURCES);</code></pre>
    </li>
    <li>
      <p>
        Configura la vista de video. El video se agrega a ExoPlayer.
      </p>
      <pre><code class="language-java" translate="No">brightcoveVideoView.add(video);</code></pre>
    </li>
    <li>
      <p>
        El SDK nativo obtiene fuentes de subtítulos y emite el siguiente evento:
      </p>
      <pre><code class="language-java" translate="No">EventType.CAPTIONS_LANGUAGES</code></pre>
    </li>
    <li>
      <p>
        Una vez que el video se agrega a ExoPlayer, el SDK nativo busca subtítulos en el manifiesto. Se agregan todos los subtítulos que no estén presentes en las fuentes de subtítulos del video. Si hay nuevas fuentes de subtítulos, se envía el siguiente evento para actualizar el controlador de medios Brightcove.
      </p>
      <pre><code class="language-java" translate="No">EventType.CAPTIONS_LANGUAGES</code></pre>
    </li>
  </ol>
</section>

<section class="bcls-section">
  <h2 id="Select_captions">Seleccionar subtítulos</h2>
  <p>
    Siga estos pasos para seleccionar subtítulos mediante programación:
  </p>
  <ol class="bcls-tasklist__restart">
    <li>
      <p>
        Cree un método para encontrar una fuente de subtítulos específica con el código de idioma. Por ejemplo:
      </p>
      <pre><code class="language-java" translate="No">private Pair&lt;Uri, BrightcoveCaptionFormat&gt; getCaptionsForLanguageCode(Video video, String languageCode) {
 Object payload = video == null ? null : video.getProperties().get(Video.Fields.CAPTION_SOURCES);

if (payload instanceof List) {
 @SuppressWarnings(&quot;unchecked&quot;)
 List&lt;Pair&lt;Uri, BrightcoveCaptionFormat&gt;&gt; pairs =
    (List&lt;Pair&lt;Uri, BrightcoveCaptionFormat&gt;&gt;) payload;

 for (Pair&lt;Uri, BrightcoveCaptionFormat&gt; pair : pairs) {
   if (pair.second.language().equals(languageCode)) {
     return pair;
   }
 }
}
return null;
}</code></pre>
    </li>
    <li>
      <p>
        Tenga en cuenta que las fuentes de subtítulos están en <code translate="No">Pair&lt;Uri, BrightcoveCaptionFormat&gt;</code>. La <code translate="No">Uri</code> en el par indica el tipo de subtítulos cerrados:
      </p>
      <ul>
        <li>
          <strong>Sidecar</strong>: La URL completa está presente
        </li>
        <li>
          <strong>En manifiesto</strong>: Se utiliza BrightcoveCaptionFormat.BRIGHTCOVE_SCHEME
        </li>
      </ul>
    </li>
    <li>
      <p>
        Cree un método responsable de seleccionar subtítulos de un video con un código de idioma dado, emitiendo el <code translate="No">EventType.SELECT_CLOSED_CAPTION_TRACK</code> evento.
      </p>
      <pre><code class="language-java" translate="No">private void selectCaption(Video video, String language) {
 Pair&lt;Uri, BrightcoveCaptionFormat&gt; pair = getCaptionsForLanguageCode(video, language);

if (pair != null &amp;&amp; !pair.first.equals(Uri.EMPTY)) {
 // BrightcoveCaptionFormat.BRIGHTCOVE_SCHEME indicates that is not a URL we need to load with the LoadCaptionsService, but instead we'll be enabled through a different component.
 if (!pair.first.toString().startsWith(BrightcoveCaptionFormat.BRIGHTCOVE_SCHEME)) {
   brightcoveVideoView.getClosedCaptioningController().getLoadCaptionsService().loadCaptions(pair.first, pair.second.type());
 }
 Map&lt;String, Object&gt; properties = new HashMap&lt;&gt;();
 properties.put(Event.CAPTION_FORMAT, pair.second);
 properties.put(Event.CAPTION_URI, pair.first);
 brightcoveVideoView.getEventEmitter().emit(EventType.SELECT_CLOSED_CAPTION_TRACK, properties);
}
}</code></pre>
    </li>
    <li>
      <p>
        Escuchar a la <code translate="No">EventType.CAPTIONS_LANGUAGES</code> evento y seleccione el idioma deseado por el código de idioma.
      </p>
      <pre><code class="language-java" translate="No">brightcoveVideoView.getEventEmitter().once(EventType.CAPTIONS_LANGUAGES, new EventListener() {
@Override
public void processEvent(Event event) {
 brightcoveVideoView.setClosedCaptioningEnabled(true);

  // You could find the desired languaged in the LANGUAGES list.
  // List&lt;String&gt; languages = event.getProperty(Event.LANGUAGES, List.class);
 selectCaption(brightcoveVideoView.getCurrentVideo(), &quot;ja&quot;);
}
});</code></pre>
    </li>

  </ol>
</section>

</article>